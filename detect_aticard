#!/bin/sh
# Author: Andreas Weber
# Date: 26.12.2006
# Purpose: Script to detect ati Cards and assign a Driver

# Creating List:
#
# grep -E '^[[:space:]].*(RADEON|FireGL) ' < /var/log/Xorg.0.log | sed -e 's/^[[:space:]]//' -e 's/, /\n/g' -e 's/,$//'     | sort

# Get Card info 
ID1=$(lspci -nn | grep "VGA\ compatible\ controller" | cut -d ' ' -f 1)
ID2=$(lspci -n | grep $ID1 | cut -d ' ' -f 3)
ID3=$(echo $ID2 | cut -d ':' -f 2 | tr '[a-z]' '[A-Z]')

case $ID3 in
4154) NAME="FireGL T2"; DRIVER="fglrx";;
5B64) NAME="FireGL V3100"; DRIVER="fglrx";;
3E54) NAME="FireGL V3200"; DRIVER="fglrx";;
7152) NAME="FireGL V3300"; DRIVER="fglrx";;
71D2) NAME="FireGL V3400"; DRIVER="fglrx";;
5E48) NAME="FireGL V5000"; DRIVER="fglrx";;
5551) NAME="FireGL V5100"; DRIVER="fglrx";;
71DA) NAME="FireGL V5200"; DRIVER="fglrx";;
7105) NAME="FireGL V5300"; DRIVER="fglrx";;
5550) NAME="FireGL V7100"; DRIVER="fglrx";;
5D50) NAME="FireGL V7200"; DRIVER="fglrx";;
7104) NAME="FireGL V7200"; DRIVER="fglrx";; 
710E) NAME="FireGL V7300"; DRIVER="fglrx";; 
710F) NAME="FireGL V7350"; DRIVER="fglrx";;
4E47) NAME="FireGL X1"; DRIVER="fglrx";;
4E4B) NAME="FireGL X2-256/X2-256t"; DRIVER="fglrx";;
4A4D) NAME="FireGL X3-256"; DRIVER="fglrx";;
4147) NAME="FireGL Z1"; DRIVER="fglrx";;
5B65) NAME="FireMV 2200"; DRIVER="fglrx";;
3151) NAME="FireMV 2400"; DRIVER="fglrx";; 
724E) NAME="FireStream 2U"; DRIVER="fglrx";; 
724F) NAME="FireStream 2U"; DRIVER="fglrx";;
7144) NAME="MOBILITY FireGL"; DRIVER="fglrx";;
4E54) NAME="MOBILITY FireGL T2/T2e"; DRIVER="fglrx";;
5464) NAME="MOBILITY FireGL V3100"; DRIVER="fglrx";;
3154) NAME="MOBILITY FireGL V3200"; DRIVER="fglrx";;
564A) NAME="MOBILITY FireGL V5000"; DRIVER="fglrx";; 
564B) NAME="MOBILITY FireGL V5000"; DRIVER="fglrx";;
5D49) NAME="MOBILITY FireGL V5100"; DRIVER="fglrx";;
71C4) NAME="MOBILITY FireGL V5200"; DRIVER="fglrx";;
71D4) NAME="MOBILITY FireGL V5250"; DRIVER="fglrx";;
7106) NAME="MOBILITY FireGL V7100"; DRIVER="fglrx";;
7103) NAME="MOBILITY FireGL V7200"; DRIVER="fglrx";;
4E52) NAME="MOBILITY RADEON 9500"; DRIVER="fglrx";;
4E56) NAME="MOBILITY RADEON 9550"; DRIVER="fglrx";;
4E50) NAME="MOBILITY RADEON 9600/9700"; DRIVER="fglrx";;
4A4E) NAME="MOBILITY RADEON 9800"; DRIVER="fglrx";; 
7149) NAME="MOBILITY RADEON X1300"; DRIVER="fglrx";;
714A) NAME="MOBILITY RADEON X1300"; DRIVER="fglrx";;
714B) NAME="MOBILITY RADEON X1300"; DRIVER="fglrx";;
714C) NAME="MOBILITY RADEON X1300"; DRIVER="fglrx";;
718C) NAME="MOBILITY RADEON X1350"; DRIVER="fglrx";;
718B) NAME="MOBILITY RADEON X1350"; DRIVER="fglrx";;
7196) NAME="MOBILITY RADEON X1350"; DRIVER="fglrx";;
7145) NAME="MOBILITY RADEON X1400"; DRIVER="fglrx";;
718D) NAME="MOBILITY RADEON X1450"; DRIVER="fglrx";;
7186) NAME="MOBILITY RADEON X1450"; DRIVER="fglrx";;
71C5) NAME="MOBILITY RADEON X1600"; DRIVER="fglrx";;
71D5) NAME="MOBILITY RADEON X1700"; DRIVER="fglrx";;
71D6) NAME="MOBILITY RADEON X1700"; DRIVER="fglrx";;
7102) NAME="MOBILITY RADEON X1800"; DRIVER="fglrx";;
7101) NAME="MOBILITY RADEON X1800 XT"; DRIVER="fglrx";;
3152) NAME="MOBILITY RADEON X300"; DRIVER="fglrx";;
5460) NAME="MOBILITY RADEON X300"; DRIVER="fglrx";;
5461) NAME="MOBILITY RADEON X300"; DRIVER="fglrx";;
3150) NAME="MOBILITY RADEON X600"; DRIVER="fglrx";;
5462) NAME="MOBILITY RADEON X600 SE"; DRIVER="fglrx";;
5652) NAME="MOBILITY RADEON X700"; DRIVER="fglrx";;
5653) NAME="MOBILITY RADEON X700"; DRIVER="fglrx";;
564F) NAME="MOBILITY RADEON X700 XL"; DRIVER="fglrx";;
5D4A) NAME="MOBILITY RADEON X800"; DRIVER="fglrx";; 
5D48) NAME="MOBILITY RADEON X800 XT"; DRIVER="fglrx";;
4E45) NAME="RADEON 9500 PRO/9700"; DRIVER="fglrx";;
4144) NAME="RADEON 9500"; DRIVER="fglrx";;
4149) NAME="RADEON 9500"; DRIVER="fglrx";; 
4153) NAME="RADEON 9550"; DRIVER="fglrx";;
4152) NAME="RADEON 9600 PRO"; DRIVER="fglrx";;
4150) NAME="RADEON 9600"; DRIVER="fglrx";;
4E51) NAME="RADEON 9600"; DRIVER="fglrx";;
4155) NAME="RADEON 9600"; DRIVER="fglrx";; 
4151) NAME="RADEON 9600 SE"; DRIVER="fglrx";;
4146) NAME="RADEON 9600 TX"; DRIVER="fglrx";; 
4E46) NAME="RADEON 9600 TX"; DRIVER="fglrx";;
4E44) NAME="RADEON 9700 PRO"; DRIVER="fglrx";;
4E48) NAME="RADEON 9800 PRO"; DRIVER="fglrx";;
4E49) NAME="RADEON 9800"; DRIVER="fglrx";;
4148) NAME="RADEON 9800 SE"; DRIVER="fglrx";;
4E4A) NAME="RADEON 9800 XT"; DRIVER="fglrx";;
7143) NAME="RADEON X1300 PRO"; DRIVER="fglrx";;
7147) NAME="RADEON X1300"; DRIVER="fglrx";;
7180) NAME="RADEON X1300"; DRIVER="fglrx";;
7183) NAME="RADEON X1300"; DRIVER="fglrx";;
7187) NAME="RADEON X1300"; DRIVER="fglrx";;
715F) NAME="RADEON X1300 Series"; DRIVER="fglrx";;
7142) NAME="RADEON X1300 Series"; DRIVER="fglrx";;
7146) NAME="RADEON X1300 Series"; DRIVER="fglrx";;
714D) NAME="RADEON X1300 Series"; DRIVER="fglrx";;
714E) NAME="RADEON X1300 Series"; DRIVER="fglrx";;
715E) NAME="RADEON X1300 Series"; DRIVER="fglrx";;
71CE) NAME="RADEON X1300 Series"; DRIVER="fglrx";;
7140) NAME="RADEON X1600 Series"; DRIVER="fglrx";;
7181) NAME="RADEON X1600 Series"; DRIVER="fglrx";;
71C0) NAME="RADEON X1600 Series"; DRIVER="fglrx";;
71C2) NAME="RADEON X1600 Series"; DRIVER="fglrx";;
71DE) NAME="RADEON X1600 Series"; DRIVER="fglrx";;
71C1) NAME="RADEON X1600 XT"; DRIVER="fglrx";;
71C6) NAME="RADEON X1650 Series"; DRIVER="fglrx";;
7100) NAME="RADEON X1800"; DRIVER="fglrx";;
7108) NAME="RADEON X1800 Series"; DRIVER="fglrx";;
7109) NAME="RADEON X1800 Series"; DRIVER="fglrx";;
710A) NAME="RADEON X1800 Series"; DRIVER="fglrx";;
710B) NAME="RADEON X1800 Series"; DRIVER="fglrx";;
710C) NAME="RADEON X1800 Series"; DRIVER="fglrx";;
7240) NAME="RADEON X1900"; DRIVER="fglrx";;
7243) NAME="RADEON X1900"; DRIVER="fglrx";;
7244) NAME="RADEON X1900"; DRIVER="fglrx";;
7245) NAME="RADEON X1900"; DRIVER="fglrx";;
7246) NAME="RADEON X1900"; DRIVER="fglrx";;
7247) NAME="RADEON X1900"; DRIVER="fglrx";;
7248) NAME="RADEON X1900"; DRIVER="fglrx";;
7249) NAME="RADEON X1900"; DRIVER="fglrx";;
724A) NAME="RADEON X1900"; DRIVER="fglrx";;
724B) NAME="RADEON X1900"; DRIVER="fglrx";;
724C) NAME="RADEON X1900"; DRIVER="fglrx";;
724D) NAME="RADEON X1900"; DRIVER="fglrx";;
5B60) NAME="RADEON X300/X550"; DRIVER="fglrx";;
5B63) NAME="RADEON X550"; DRIVER="fglrx";;
5B62) NAME="RADEON X600"; DRIVER="fglrx";;
3E50) NAME="RADEON X600/X550 Series"; DRIVER="fglrx";;
5E4B) NAME="RADEON X700 PRO"; DRIVER="fglrx";;
5E4D) NAME="RADEON X700"; DRIVER="fglrx";;
5E4C) NAME="RADEON X700 SE"; DRIVER="fglrx";;
5E4F) NAME="RADEON X700/X550 Series"; DRIVER="fglrx";;
5E4A) NAME="RADEON X700 XT"; DRIVER="fglrx";;
5549) NAME="RADEON X800 GTO"; DRIVER="fglrx";;
554F) NAME="RADEON X800 GTO"; DRIVER="fglrx";;
5D4F) NAME="RADEON X800 GTO"; DRIVER="fglrx";;
554B) NAME="RADEON X800 GT"; DRIVER="fglrx";;
554E) NAME="RADEON X800 GT"; DRIVER="fglrx";;
4A49) NAME="RADEON X800 PRO"; DRIVER="fglrx";;
4A48) NAME="RADEON X800"; DRIVER="fglrx";;
4A4C) NAME="RADEON X800"; DRIVER="fglrx";;
5548) NAME="RADEON X800"; DRIVER="fglrx";;
4A4A) NAME="RADEON X800 SE"; DRIVER="fglrx";;
4A4F) NAME="RADEON X800 SE"; DRIVER="fglrx";;
4A54) NAME="RADEON X800 VE"; DRIVER="fglrx";;
554D) NAME="RADEON X800 XL"; DRIVER="fglrx";;
4A50) NAME="RADEON X800 XT Platinum Edition"; DRIVER="fglrx";;
554A) NAME="RADEON X800 XT Platinum Edition"; DRIVER="fglrx";;
4A4B) NAME="RADEON X800 XT"; DRIVER="fglrx";;
5D57) NAME="RADEON X800 XT"; DRIVER="fglrx";;
4B4B) NAME="RADEON X850 PRO"; DRIVER="fglrx";;
4B48) NAME="RADEON X850"; DRIVER="fglrx";;
4B4A) NAME="RADEON X850 SE"; DRIVER="fglrx";;
5D4D) NAME="RADEON X850 XT Platinum Edition"; DRIVER="fglrx";;
4B4C) NAME="RADEON X850 XT Platinum Edition"; DRIVER="fglrx";;
5D52) NAME="RADEON X850 XT"; DRIVER="fglrx";;
4B49) NAME="RADEON X850 XT"; DRIVER="fglrx";;
7941) NAME="RADEON Xpress 1200"; DRIVER="fglrx";;
7942) NAME="RADEON Xpress 1200"; DRIVER="fglrx";;
5A62) NAME="RADEON XPRESS 200M"; DRIVER="fglrx";;
5A42) NAME="RADEON XPRESS 200M"; DRIVER="fglrx";;
5955) NAME="RADEON XPRESS 200M"; DRIVER="fglrx";;
5975) NAME="RADEON XPRESS 200M"; DRIVER="fglrx";;
5A61) NAME="RADEON XPRESS 200"; DRIVER="fglrx";;
5A41) NAME="RADEON XPRESS 200"; DRIVER="fglrx";;
5954) NAME="RADEON XPRESS 200"; DRIVER="fglrx";;
5974) NAME="RADEON XPRESS 200"; DRIVER="fglrx";;
*) NAME="Unknown ATI Card"; DRIVER="ati";;
esac

if [ $DRIVER = "ask" ]; then
	echo "Your Card isn't supported by the linux fglrx driver."
	echo ""
	DRIVER="ati"
fi

echo "Detected Card: $NAME"
echo "Driver: $DRIVER"
echo "PCI ID: $ID3"

